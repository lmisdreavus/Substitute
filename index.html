<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <title>Pokemon Info</title>
</head>
<body>
    <div class="container">
        <h1 class="mt-5">Pokemon Info</h1>
        <form class="mt-4" id="search-form" onsubmit="event.preventDefault(); search(event)">
            <div class="input-group">
                <input type="text" id="search" class="form-control" onkeyup="showSuggestions(event)" placeholder="Search...">
                <div class="input-group-append">
                    <button class="btn btn-outline-secondary" type="submit">Search</button>
                </div>
            </div>
            <div id="suggestions" class="list-group mt-2"></div>
        </form>
        <div class="mt-5" id="result"></div>
    </div>

    <script>
        var databases = {
            "pokemon": null,
            "move": null,
            "ability": null
        };

        fetch('pokemon.json')
            .then(response => response.json())
            .then(data => { databases.pokemon = data; });

        fetch('move.json')
            .then(response => response.json())
            .then(data => { databases.move = data; });

        fetch('ability.json')
            .then(response => response.json())
            .then(data => { databases.ability = data; });

        function showSuggestions(event) {
            var input = document.getElementById("search").value.toLowerCase();
            var suggestions = document.getElementById("suggestions");

            if (event.key === 'Enter') {
                suggestions.innerHTML = '';
                return;
            }

            while(suggestions.firstChild) {
                suggestions.removeChild(suggestions.firstChild);
            }

            for(var category in databases) {
                var database = databases[category];

                if(database) {
                    for(var name in database) {
                        if(name.toLowerCase().startsWith(input) && input !== '') {
                            var div = document.createElement("div");
                            div.textContent = name;
                            div.setAttribute("class", "list-group-item list-group-item-action");
                            div.addEventListener("click", function() {
                                document.getElementById("search").value = this.textContent;
                                search(new Event('submit'));
                            });
                            suggestions.appendChild(div);
                        }
                    }
                }
            }
        }

        function search(event) {
            var input = document.getElementById("search").value.toLowerCase();
            var result = document.getElementById("result");

            while(result.firstChild) {
                result.removeChild(result.firstChild);
            }

            for(var category in databases) {
                var database = databases[category];

                if(database) {
                    var data = database[input];
                    if(data) {
                        for(var key in data) {
                            var p = document.createElement("p");
                            p.textContent = key + " : " + data[key];
                            result.appendChild(p);
                        }
                    }
                }
            }
        }
    </script>
</body>
</html>
