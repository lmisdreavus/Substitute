<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokemon Search</title>

    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">

    <style>
        .suggestions {
            position: absolute;
            border: 1px solid #d4d4d4;
            border-bottom: none;
            border-top: none;
            z-index: 99;
            top: 100%;
            left: 0;
            right: 0;
        }

        .suggestions div {
            padding: 10px 20px;
            cursor: pointer;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .suggestions .selected {
            background-color: #d4d4d4;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <form id="searchForm" onsubmit="event.preventDefault(); search()">
            <input type="text" id="search" class="form-control" placeholder="Search" autocomplete="off" onkeyup="suggestions(this.value)">
            <div class="suggestions" id="suggestions"></div>
        </form>
        <div id="result" class="mt-3"></div>
    </div>

    <script>
        var databases = {
            'pokemon': null,
            'move': null,
            'ability': null
        };

        // Load all databases
        for(var category in databases) {
            loadDatabase(category);
        }

        function loadDatabase(category) {
            fetch(category + '.json')
                .then(response => response.json())
                .then(data => databases[category] = data);
        }

        function search() {
            var input = document.getElementById("search").value.toLowerCase();
            var result = document.getElementById("result");

            while(result.firstChild) {
                result.removeChild(result.firstChild);
            }

            for(var category in databases) {
                var database = databases[category];

                if(database) {
                    var data = database[input];
                    if(data) {
                        // Create table for 'pokemon' category
                        if (category === 'pokemon') {
                            var table = document.createElement('table');
                            table.className = 'table table-striped';

                            var trHead = document.createElement('tr');
                            var trData = document.createElement('tr');

                            for(var key in data) {
                                var th = document.createElement('th');
                                th.textContent = key;
                                trHead.appendChild(th);

                                var td = document.createElement('td');
                                td.textContent = data[key];
                                trData.appendChild(td);
                            }

                            table.appendChild(trHead);
                            table.appendChild(trData);
                            result.appendChild(table);
                        }
                        // Non-table data for other categories
                        else {
                            for(var key in data) {
                                var p = document.createElement("p");
                                p.textContent = key + " : " + data[key];
                                result.appendChild(p);
                            }
                        }
                    }
                }
            }
        }

        function suggestions(searchText) {
            var suggestions = document.getElementById('suggestions');

            while(suggestions.firstChild) {
                suggestions.removeChild(suggestions.firstChild);
            }

            if(searchText.length === 0) {
                return;
            }

            var searchLower = searchText.toLowerCase();

            for(var category in databases) {
                var database = databases[category];

                if(database) {
                    for(var key in database) {
                        if(key.includes(searchLower)) {
                            var div = document.createElement("div");
                            div.textContent = key;
                            div.addEventListener('click', function() {
                                document.getElementById('search').value = this.textContent;
                                search();
                                while(suggestions.firstChild) {
                                    suggestions.removeChild(suggestions.firstChild);
                                }
                            });
                            suggestions.appendChild(div);
                        }
                    }
                }
            }
        }
    </script>
</body>
</html>
