<!DOCTYPE html>
<html>
<head>
    <title>포켓몬 검색</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    <style>
        #suggestions {
            position: absolute;
            width: 100%;
            z-index: 100;
            top: 38px;  /* Adjust this value as needed */
        }
    </style>
</head>
<body class="container pt-4">
    <h1 class="text-center mb-4">포켓몬 검색</h1>

    <div class="input-group position-relative mb-3">
        <form id="searchForm" class="input-group">
            <input type="text" id="search" class="form-control" placeholder="포켓몬 이름을 입력하세요" onkeyup="showSuggestions()">
            <div class="input-group-append">
                <button type="submit" class="btn btn-outline-secondary">검색</button>
            </div>
        </form>
        <div id="suggestions" class="list-group"></div>
    </div>

    <table class="table table-striped" id="result">
    </table>

    <script>
        var database;

        fetch('./data.json')
            .then(response => response.json())
            .then(data => database = data)
            .catch(error => console.error('Error:', error));

        function search(event) {
            event.preventDefault();
            var searchName = document.getElementById("search").value;
            var resultTable = document.getElementById("result");

            while(resultTable.rows.length > 0) {
                resultTable.deleteRow(0);
            }

            if(database[searchName]) {
                var newRow = resultTable.insertRow(-1);
                newRow.insertCell(0).innerText = "포켓몬";
                newRow.insertCell(1).innerText = searchName;

                for(var key in database[searchName]) {
                    newRow = resultTable.insertRow(-1);
                    newRow.insertCell(0).innerText = key;
                    newRow.insertCell(1).innerText = database[searchName][key];
                }
            } else {
                alert("해당하는 포켓몬을 찾을 수 없습니다.");
            }

            document.getElementById('suggestions').innerHTML = '';
        }

        function showSuggestions() {
            var input = document.getElementById("search").value.toLowerCase();
            var suggestions = document.getElementById("suggestions");

            // Clear any existing suggestions
            while(suggestions.firstChild) {
                suggestions.removeChild(suggestions.firstChild);
            }

            for(var name in database) {
                if(name.toLowerCase().startsWith(input) && input !== '') {
                    var div = document.createElement("div");
                    div.textContent = name;
                    div.setAttribute("class", "list-group-item list-group-item-action");
                    div.addEventListener("click", function() {
                        document.getElementById("search").value = this.textContent;
                        search(new Event('submit'));
                    });
                    suggestions.appendChild(div);
                }
            }
        }

        document.getElementById('searchForm').addEventListener('submit', search);
    </script>
</body>
</html>
