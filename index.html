<!DOCTYPE html>
<html>
<head>
    <title>Pokemon Search</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <style>
        #result {
            margin-top: 20px;
        }
        .suggestion {
            cursor: pointer;
        }
    </style>
    <script>
        var databases = {
            'pokemon': null,
            'move': null,
            'ability': null
        };

        window.onload = function() {
            // Fetch data for each category from respective JSON file
            for(var category in databases) {
                fetch(category + '.json')
                .then(response => response.json())
                .then(data => {
                    databases[category] = data;
                });
            }

            var searchElement = document.getElementById('search');
            searchElement.addEventListener('input', suggest);
            searchElement.addEventListener('keydown', handleKeyDown);
        };

        function handleKeyDown(e) {
            if(e.key === 'Enter') {
                e.preventDefault(); 
                search();
                clearSuggestions();
            }
        }

        function suggest() {
            var input = document.getElementById('search').value.toLowerCase();
            var suggestions = document.getElementById('suggestions');

            clearSuggestions();

            for(var category in databases) {
                var database = databases[category];

                if(database) {
                    for(var key in database) {
                        if(key.startsWith(input)) {
                            var div = document.createElement('div');
                            div.textContent = key;
                            div.className = 'suggestion';
                            div.onclick = function() {
                                document.getElementById('search').value = this.textContent;
                                search();
                                clearSuggestions();
                            };
                            suggestions.appendChild(div);
                        }
                    }
                }
            }
        }

        function search() {
            var input = document.getElementById('search').value.toLowerCase();
            var result = document.getElementById('result');

            while(result.firstChild) {
                result.removeChild(result.firstChild);
            }

            for(var category in databases) {
                var database = databases[category];

                if(database) {
                    var data = database[input];
                    if(data) {
                        // Create table for 'pokemon' category
                        if (category === 'pokemon') {
                            var table = document.createElement('table');
                            table.className = 'table table-striped';

                            var trHead = document.createElement('tr');
                            var trData = document.createElement('tr');

                            for(var key in data) {
                                var th = document.createElement('th');
                                th.textContent = key;
                                trHead.appendChild(th);

                                var td = document.createElement('td');
                                td.textContent = data[key];
                                trData.appendChild(td);
                            }

                            table.appendChild(trHead);
                            table.appendChild(trData);
                            result.appendChild(table);
                        }
                        // Non-table data for other categories
                        else {
                            for(var key in data) {
                                var p = document.createElement('p');
                                p.textContent = key + " : " + data[key];
                                result.appendChild(p);
                            }
                        }
                    }
                }
            }
        }

        function clearSuggestions() {
            var suggestions = document.getElementById('suggestions');

            while(suggestions.firstChild) {
                suggestions.removeChild(suggestions.firstChild);
            }
        }
    </script>
</head>
<body>
    <div class="container">
        <h1 class="text-center my-4">Pokemon Search</h1>
        <form onsubmit="event.preventDefault();">
            <div class="input-group">
                <input type="text" id="search" class="form-control" placeholder="Search...">
                <div class="input-group-append">
                    <button class="btn btn-outline-secondary" type="button" onclick="search(); clearSuggestions();">Search</button>
                </div>
            </div>
            <div id="suggestions" class="border border-secondary mt-2 p-2" style="display: none;"></div>
        </form>
        <div id="result"></div>
    </div>
</body>
</html>
